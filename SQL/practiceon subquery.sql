create database flipkart;

							---------sales table----------
create table salesman(salesman_id int primary key,name varchar(20),city varchar (20),commision dec(10,2))
insert into salesman values(5001,'James Hoog','New York ', 0.15),
							(5002,'Nail Knite','Paris',0.13),
							(5005,'Pit Alex ','london',0.11),
							(5006,'Mc Lyon','paris',0.14),
							(5007,'Paul Adam','Rome',0.13),
							(5003,'Lauson Hen','San Jose',0.12)

							--------customer table-----
create table customer1(cust_id int primary key,cust_name varchar(30),cust_city varchar(30),grade int,salesman_id int,
constraint c1 foreign key (salesman_id) references salesman (salesman_id))
insert into customer1 values( 3002,'Nick Rimando	','New York',100,5001),
							( 3007,'Brad Davis ','New York',200,5001),
							( 3005,'Graham Zusi ','california',200,5002),
							( 3008,'Julian Green ','london',300,5002),
							( 3004,'Fabian Johnson ','paris',300,5006),
							( 3009,'Geoff Cameron  ','berlin',100,5003),
							( 3003,'Jozy Altidor','moscow',200,5007)
insert into customer1 (cust_id,cust_name,cust_city,salesman_id)values( 3001,'Brad Guzan ','london',5005)


					  ------order table------
create table ordertable1(ord_no int primary key,purch_amt dec(10,2),ord_date varchar(20),cust_id int,salesman_id int,
constraint q foreign key (salesman_id) references salesman(salesman_id),constraint q1 foreign key (cust_id) references customer1(cust_id))

insert into ordertable1 values (70001,150.5,'2012-10-05 ' ,3005 , 5002),
						(70009 ,270.65,'2012-09-10',3001,5005),
						(70002,65.26,'2012-10-05',3002,5001),
						(70004 ,110.5,'2012-08-17', 3009,5003),
						(70007,948.5,'2012-09-10',3005,5002),
						(70005,2400.6,'2012-07-27',3007,5001),
						(70008,5760,'2012-09-10',3002,5001),
						(70010,1983.43,'2012-10-10',3004,5006),
						(70003,2480.4,'2012-10-10',3009,5003),
						(70012,250.45,'2012-06-27',3008,5002),
						(70011,75.29,'2012-08-17',3003,5007),
						(70013,3045.6,'2012-04-25',3002, 5001)

						select*from ordertable1
						

---------------
---------------QUERIES
--1 From the following tables, write a SQL query to find all the orders issued by the salesman 'Paul Adam'. Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

SELECT *  from ordertable1 where salesman_id =(select salesman_id from salesman where name='paul adam')

--2. From the following tables write a SQL query to find all orders generated by London-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

select* from ordertable1 where salesman_id=(select salesman_id from salesman where city ='london')

--3. From the following tables write a SQL query to find all orders generated by the salespeople who may work for customers whose id is 3007. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.
---select*from ordertable1 where cust_id =3007;----

select * from ordertable1 where salesman_id =(select distinct salesman_id from ordertable1 where cust_id =3007)

--4. From the following tables write a SQL query to find the order values greater than the average order value of 10th October 2012. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

select *from ordertable1 where purch_amt > (select avg(purch_amt) from ordertable1 where ord_date='2012-10-10')

--5. From the following tables, write a SQL query to find all the orders generated in New York city. Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

select * from ordertable1 where salesman_id =(select salesman_id from salesman where city='New York')

--6. From the following tables write a SQL query to determine the commission of the salespeople in Paris. Return commission

select commision from salesman where salesman_id in ( select salesman_id from customer1 where city='Paris');

--7. Write a query to display all the customers whose ID is 2001 below the salesperson ID of Mc Lyon.

select * from customer1 where cust_id in(select salesman_id  -2001 from salesman where name='Mc Lyon' );

--8. write a SQL query to count the number of customers with grades above the average in New York City. Return grade and count.

select grade ,count(*) as 'count' from customer1 group by grade having  grade> (select avg (grade) from customer where cust_city ='new york')

--9 write a SQL query to find those salespeople who earned the maximum commission. Return ord_no, purch_amt, ord_date, and salesman_id.

select * from ordertable1 where salesman_id =(select salesman_id from salesman where commision =(select max (commision) from salesman ))

--10. write SQL query to find the customers who placed orders on 17th August 2012. Return ord_no, purch_amt, ord_date, customer_id, salesman_id and cust_name.

select o.* ,c.cust_name from ordertable1 o , customer1 c where o.salesman_id=c.salesman_id and o.ord_date='2012-08-17'

--11. write a SQL query to find salespeople who had more than one customer. Return salesman_id and name.

select salesman_id ,name from salesman a where 1 < (select count(*) from customer where salesman_id=a.salesman_id)

--12. write a SQL query to find those orders, which are higher than the average amount of the orders.
--Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

select * from ordertable1 a where purch_amt > (select avg (purch_amt) from ordertable1 b  where a.cust_id=b.cust_id )

--13. write a SQL query to find those orders that are equal or higher than the average amount of the orders. 
--Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

 select * from ordertable1 a where purch_amt >= (select avg (purch_amt) from ordertable1 b  where a.cust_id=b.cust_id )

 --14 query to find the sums of the amounts from the orders table, grouped by date, and eliminate all dates 
 --where the sum was not at least 1000.00 above the maximum order amount for that date.

 select ord_date,sum(purch_amt) from ordertable1 a group by ord_date having sum (purch_amt) > (select 1000.00 + max(purch_amt) from ordertable1 b where a.ord_date=b.ord_date);

 --15. Write a query to extract all data from the customer table if and only if one or more of the customers in the customer table are located in London.

 select * from customer1  where exists (select * from customer1 where cust_city='london')

 --16. write a SQL query to find salespeople who deal with multiple customers. Return salesman_id, name, city and commission.

 select * 